# Cursor 多版本管理工具

這是一個用於 Windows 環境的 Cursor 編輯器多版本管理腳本，允許用戶在多個 Cursor 版本之間輕鬆切換。

## 功能特色

- 創建及管理多個 Cursor 版本的隔離環境
- 通過符號連結實現版本快速切換
- 提供桌面捷徑和啟動批處理檔
- 允許直接啟動特定版本而不切換系統路徑
- 多版本配置共享或隔離選項
- 安全地刪除不再需要的版本

## 適用場景

- 需要同時使用或測試多個 Cursor 版本的用戶
- 想要保留舊版本功能同時嘗試新版本的用戶
- 團隊成員需要使用不同版本確保兼容性的環境
- 需要清理舊版本以釋放空間或簡化管理的用戶

## 資料夾結構

腳本預期一個基礎目錄來存放所有版本資料和腳本身體。建議的結構如下：

  [您的基礎目錄]\Cursor_Versions\  (此路徑可在腳本中設定)
  ├── 版本1\
  │   ├── Config/  - 此版本的設定資料夾
  │   └── Program/ - 此版本的程式資料夾 (Cursor 安裝於此)
  ├── 版本2\
  │   ├── Config/
  │   └── Program/
  └── Cursor_Switch.ps1 - 主腳本 (建議放置於 [您的基礎目錄]\Cursor_Versions\ 中)

**注意：** `[您的基礎目錄]` 是您選擇存放 `Cursor_Versions` 資料夾的位置，例如 `C:\Tools`、`D:\PortableApps` 等。腳本內的 `$cursorVersionsDir` 變數控制此路徑。

## 使用方法

1.  **設定基礎目錄：**
    * 打開 `Cursor_Switch.ps1` 腳本。
    * 修改腳本頂部的 `$cursorVersionsDir` 變數，將其指向您希望存放所有 Cursor 版本的資料夾路徑，例如：`$cursorVersionsDir = "C:\MyCursorVersions"` 或 `$cursorVersionsDir = "$PSScriptRoot"` (如果腳本與版本資料夾在同一層級，並希望使用相對路徑概念)。預設為 `"D:\Cursor_Versions"`。
2.  **儲存腳本：** 將修改後的 `Cursor_Switch.ps1` 腳本儲存到您規劃的位置，例如直接放在您設定的 `$cursorVersionsDir` 內。
3.  **以管理員身份運行 PowerShell：**
    * 在開始選單搜尋 "PowerShell"。
    * 右鍵點擊 "Windows PowerShell"，選擇 "以系統管理員身分執行"。
4.  **導航到腳本目錄：**
    在 PowerShell 中，切換到您儲存腳本的目錄。例如：
    假設您的基礎目錄是 `C:\MyCursorVersions`，且腳本也存放在此，則輸入：
    `cd C:\MyCursorVersions`

    如果您將腳本與 `Cursor_Versions` 資料夾放在同一個您選擇的基礎目錄下，可以直接 `cd` 到該目錄。
5.  **執行腳本：**
    在 PowerShell 中輸入以下命令之一：
    `powershell -ExecutionPolicy Bypass -File .\Cursor_Switch.ps1`

    或者，如果 PowerShell 的執行策略允許：
    `.\Cursor_Switch.ps1`
6.  **依照選單操作。**

## 主要功能

腳本提供以下主要功能，可通過選單進行操作：

1.  **建立新版本**：創建新的 Cursor 版本隔離環境。
2.  **切換系統連結版本**：更改系統預設 (`%LOCALAPPDATA%\Programs\cursor` 和 `%APPDATA%\Cursor`) 指向的 Cursor 版本。
3.  **更新特定版本**：先切換到指定版本，然後提示用戶運行 Cursor 內建的更新程序。
4.  **還原特定版本到預設路徑**：與「切換系統連結版本」功能類似，確保指定版本成為系統預設。
5.  **初始化現有 Cursor 安裝為版本管理**：將系統中已存在的標準 Cursor 安裝轉換為此管理工具下的一個版本。
6.  **創建版本啟動捷徑**：為特定版本在桌面或開始選單創建獨立的啟動捷徑。
7.  **創建版本啟動批處理檔**：為特定版本創建 `.bat` 啟動檔，方便通過命令列或排程啟動。
8.  **直接啟動特定版本**：在不更改當前系統連結版本的情況下，直接啟動選定的 Cursor 版本。
9.  **為所有版本創建啟動器**：批量為所有已存在的版本創建捷徑和/或批處理啟動檔。
10. **重命名版本**：修改已建立版本的名稱，並更新相關的捷徑和設定。
11. **刪除版本**：永久移除指定的 Cursor 版本，包括其程式檔案、設定資料夾以及相關的捷徑。**(此操作無法復原，請謹慎使用)**

## 系統要求

- Windows 10/11
- PowerShell 5.1 或更高版本
- 執行腳本需要系統管理員權限（用於創建符號連結、修改系統路徑下的項目以及寫入 Program Files 相關區域）。

## 注意事項

* **路徑配置：** 腳本頂部的 `$cursorVersionsDir` 變數至關重要，它定義了所有版本資料的存放位置。請在使用前根據您的實際情況進行配置。`$cursorProgramPath` 和 `$cursorConfigPath` 通常不需要更改，它們指向 Cursor 預設的安裝和設定位置。
* **符號連結：** 此工具的核心是使用符號連結 (Symbolic Links) 來指向不同版本的程式和設定資料夾。這意味著實際的檔案儲存在各個版本特定的資料夾中。
* **首次使用 `Initialize-CursorVersionManagement`：** 如果您已經安裝了 Cursor 並希望將其納入版本管理，請先使用「初始化」功能。
* **更新 Cursor：** 當您想更新某個特定版本時，請先使用腳本切換到該版本，然後正常啟動 Cursor 並使用其內建的更新功能。更新將應用於當前啟用的版本。
* **刪除操作：** 刪除版本是一個永久性操作，會移除該版本的所有檔案。在執行前會有確認提示，請務必確認您選擇了正確的版本。

## 授權

此腳本按原樣提供，不附帶任何明示或暗示的保證。使用者需自行承擔使用此腳本可能帶來的所有風險。
建議在使用前備份重要資料。
